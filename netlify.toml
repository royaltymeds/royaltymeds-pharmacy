[build]
  command = "npm run build"
  publish = ".next"

[build.environment]
  # Only pass PUBLIC environment variables to the build
  # Private keys like SUPABASE_SERVICE_ROLE_KEY, SUPABASE_DB_URL, SUPABASE_REF
  # should NOT be available during build time - they will cause them to be
  # embedded in the built code
  NEXT_PUBLIC_SUPABASE_ANON_KEY = ""
  NEXT_PUBLIC_SUPABASE_URL = ""
  NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY = ""
  STORAGE_BUCKET = ""
  
  # These are intentionally NOT set here - set them only in Netlify UI environment context
  # SUPABASE_SERVICE_ROLE_KEY
  # SUPABASE_DB_URL
  # SUPABASE_REF
  
  # Omit expected public environment variables from secrets scanning
  # These are public Supabase keys that can be exposed to the client
  SECRETS_SCAN_OMIT_KEYS = "NEXT_PUBLIC_SUPABASE_ANON_KEY,NEXT_PUBLIC_SUPABASE_URL,NEXT_PUBLIC_SUPABASE_PUBLISHABLE_DEFAULT_KEY,STORAGE_BUCKET"
  # Omit paths containing code and documentation
  SECRETS_SCAN_OMIT_PATHS = "docs/**,node_modules/**,.next/**,.netlify/**,.git/**"

[[headers]]
  for = "/_next/static/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/api/*"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"
